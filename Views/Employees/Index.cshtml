@model IEnumerable<EmployeeCrudPdf.Models.Employee>
@{
  var q = ViewBag.Query as string; int page = ViewBag.Page; int pageSize = ViewBag.PageSize; int total = ViewBag.Total;
  bool useLinq = ViewBag.UseLinq is bool b && b;
  int totalPages = (int)Math.Ceiling((double)total / pageSize);
}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="mb-0">Employees</h2>
  <div class="d-flex gap-2">
    <a class="btn btn-secondary" href="?q=@q&page=1&pageSize=@pageSize&useLinq=@(!useLinq)">
      @(useLinq ? "Use DB Search" : "Use LINQ Search")
    </a>
    <a class="btn btn-primary" asp-action="Create" data-nav-check="Employees/NewButton">+ New Employee</a>
  </div>
</div>

<form class="row row-cols-lg-auto g-2 align-items-center mb-3" method="get">
  <input type="hidden" name="useLinq" value="@useLinq" />
  <div class="col-12"><input name="q" class="form-control" placeholder="Search name/department/email" value="@q" /></div>
  <div class="col-12"><button class="btn btn-outline-secondary" type="submit">Search</button></div>
</form>

<table class="table table-striped table-hover">
  <thead><tr><th>Id</th><th>Name</th><th>Department</th><th>Email</th><th class="text-end">Salary</th><th></th></tr></thead>
  <tbody>
  @foreach (var e in Model)
  {
    <tr>
      <td>@e.Id</td>
      <td>@e.Name</td>
      <td>@e.Department</td>
      <td>@e.Email</td>
      <td class="text-end">@e.Salary.ToString("C")</td>
      <td class="text-end">
        <a class="btn btn-sm btn-outline-secondary" asp-action="Details" asp-route-id="@e.Id" data-nav-check="Employees/ViewButton">View</a>
        <a class="btn btn-sm btn-outline-primary" asp-action="Edit" asp-route-id="@e.Id" data-nav-check="Employees/EditButton">Edit</a>
        <a class="btn btn-sm btn-outline-danger" asp-action="Delete" asp-route-id="@e.Id" data-nav-check="Employees/DeleteButton">Delete</a>
      </td>
    </tr>
  }
  </tbody>
</table>

@if (totalPages > 1)
{
  <nav>
    <ul class="pagination">
      @for (int i = 1; i <= totalPages; i++)
      {
        <li class="page-item @(i==page?"active":"")">
          <a class="page-link" href="?q=@q&page=@i&pageSize=@pageSize">@i</a>
        </li>
      }
    </ul>
  </nav>
}
